<!DOCTYPE html>
<html lang="es">
    <head>
        <!-- Define el conjunto de caracteres y la escala para dispositivos móviles -->
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Fútbol Piloto</title>

        <!-- Enlace a la fuente 'Anton' desde Google Fonts -->
        <link href="https://fonts.googleapis.com/css2?family=Anton&display=swap" rel="stylesheet">

        <!-- Enlaces a hojas de estilo CSS -->
        <link rel="stylesheet" href="head.css"> <!-- Estilo para la cabecera -->
        <link rel="stylesheet" href="mainPage.css"> <!-- Estilo para la página principal -->
        <link rel="stylesheet" href="courtsPage.css">
        <link rel="stylesheet" href="communityPage.css">
        <link rel="stylesheet" href="info.css">
        <link rel="stylesheet" href="about.css">
        <link rel="stylesheet" href="format.css">
        <link rel="stylesheet" href="login.css">

        <style>
            /* Estilo para el contenedor del mapa */
            #map {
                height: 500px; /* Altura del mapa */
                width: 100%;   /* Ancho del mapa */
                margin-top: 20px;
            }
        </style>
    </head>
    <body>
        <!-- Cabecera del sitio web -->
        <header id="head">
            <h1 id="title">Fútbol Piloto</h1>
        
            <!-- Contenedor de botones de login y registro -->
            <div id="login-buttons" class="button-container">
                <button id="login-btn" class="head-btn" aria-label="Ingresar">Ingresar</button>
                <button id="register" class="head-btn" aria-label="Registrarse">¿Tienes una cancha? Súbela aquí</button>
            </div>
        
            <!-- Navegación entre las diferentes secciones -->
            <nav id="nav-buttons" class="button-container">
                <!-- Botones de navegación con la clase 'head-btn' y un atributo data-target que corresponde al ID de cada página -->
                <button class="head-btn" id="main-btn" data-target="main-page">Principal</button>
                <button class="head-btn" id="courts-btn" data-target="courts-page">Canchas</button>
                <button class="head-btn" id="community-btn" data-target="community-page">Comunidad</button>
                <button class="head-btn" id="info-btn" data-target="info-page">Información</button>
                <button class="head-btn" id="about-btn" data-target="about-page">Sobre nosotros</button>
            </nav>
        </header>

        <!-- Sección de la página principal (inicialmente visible) -->
        <main id="main-page" class="show">
            <p id="msg-main">¡Bienvenido a Fútbol Piloto!
                Encuentra tus canchas favoritas cerca de ti y haz tu reserva en tiempo real.
                Explora, elige y juega sin complicaciones. ¡Tu próxima jugada empieza aquí!</p>
            
            <!-- Contenedor del mapa (será inicializado en el archivo map.js) -->
            <div id="map"></div>      
            <p id="copyright">© 2025 Universidad Piloto de Colombia. 
                Todos los derechos reservados. 
                Somos estudiantes de la Universidad Piloto de Colombia, trabajando en este proyecto como parte de nuestra formación académica.
            </p>      
        </main>

        <!-- Sección para ver las canchas disponibles -->
        <main id="courts-page" class="hidden">
            <p id="msg-courts">¡Explora las canchas disponibles para ti!</p>
            <div id="courts">
                <!-- Aquí se mostrarán las canchas disponibles -->
            </div>
        </main>

        <!-- Sección para unirse a la comunidad -->
        <main id="community-page" class="hidden">
            <p id="msg-community">¡Únete a nuestra Comunidad!
                En Fútbol Piloto, creemos que el fútbol es más que un deporte, es una forma de conectar con nuevas personas. Si buscas un equipo para jugar o simplemente quieres unirte a otros futboleros, este es el lugar indicado.
                Encuentra compañeros de juego, organiza partidos y comparte la pasión por el fútbol. ¡Juntos somos más!</p>
            <div id="forum">
                <!-- Aqui se muestra el foro con las preguntas de la comunidad -->
            </div>
        </main>

        <!-- Sección para unirse a la comunidad -->
        <main id="info-page" class="hidden">
            <p id="msg-info">¡Bienvenido a Fútbol Piloto!</p>
            <p id="info-text">
               Fútbol Piloto es una plataforma innovadora creada para facilitar la búsqueda y reserva de canchas sintéticas en tu ciudad. Nuestro objetivo es conectar a futboleros apasionados, haciendo que la experiencia de jugar sea más accesible y divertida. Ya sea que busques una cancha cercana para jugar con amigos o desees organizar un partido, nuestra plataforma está diseñada para hacer todo más sencillo, con información actualizada y opciones en tiempo real.
            </p>
            <p id="contact-text">
                Si tienes alguna pregunta, sugerencia o deseas obtener más información, no dudes en ponerte en contacto con nosotros. ¡Estamos aquí para ayudarte!
            </p>
            <p id="contact-info">
                Correo electrónico: <a href="mailto:santiago-chavez@upc.edu.co">santiago-chavez@upc.edu.co</a><br>
                Teléfono: <a href="tel:+573223691238">+57 322 369 1238</a>
            </p>

        </main>

        <main id="about-page" class="hidden">
            <p id="msg-about">¿Quiénes somos?</p>
            <p id="about-text">
                <!-- Aqui se muestra el foro con las preguntas de la comunidad -->
                Somos estudiantes de sexto semestre de la carrera de Ingeniería de Sistemas de la Universidad Piloto de Colombia, y actualmente cursamos la materia de Desarrollo Web.

                Este proyecto, Fútbol Piloto, surge como parte de nuestro proceso de aprendizaje, con el propósito de aplicar nuestros conocimientos en el desarrollo de aplicaciones web funcionales, atractivas e interactivas. A través de esta plataforma buscamos facilitar la búsqueda y reserva de canchas sintéticas, así como promover la creación de una comunidad futbolera conectada digitalmente.
                
                Nos apasiona la tecnología, el trabajo en equipo y, por supuesto, el fútbol. Este proyecto refleja nuestro compromiso con la innovación y nuestra motivación por seguir aprendiendo y creando soluciones útiles para las personas.
            </p>
        </main>

                <!-- Modal de login -->
        <div id="login-menu" class="modal-overlay hidden">
            <div class="modal-content">
                <h2 id="login-text">Iniciar sesión</h2>
                <form id="login-form">
                    <input id="login-email" type="text" placeholder="Correo electrónico" required>
                    <input id="login-password" type="password" placeholder="Contraseña" required>

                    <!-- Opciones de registro y admin -->
                    <p><a href="#" id="open-register" class="modal-link">¿No estás registrado? ¡Únete a nosotros!</a></p>
                    <p><a href="#cancha" class="modal-link">¿Eres una cancha? ¡Ingresa aquí!</a></p>
                    <a href="#admin" id="admin-link" class="modal-link">Ingresar como administrador</a>
                    
                    <!-- Contenedor para los botones -->
                    <div class="button-container">
                        <button id="login-inner-btn" type="submit">Ingresar</button>
                        <button id="close-modal-btn" type="button">Cerrar</button>
                    </div>
                </form>       
            </div>            
        </div>  

                <!-- Modal para ingresar como Cancha -->
        <div id="cancha-menu" class="modal-overlay hidden">
            <div class="modal-content">
                <h2 id="cancha-text">Ingresar como Cancha</h2>
                <form>
                    <input type="text" placeholder="Nombre de la cancha" required>
                    <input type="text" placeholder="Código de acceso" required>
                    
                    <!-- Contenedor para los botones -->
                    <div class="button-container">
                        <button id="cancha-inner-btn" type="submit">Ingresar</button>
                        <button id="close-cancha-btn" type="button">Cerrar</button>
                        <button id="redirect-login-cancha-btn" type="button">Volver al Login</button>
                    </div>
                </form>       
            </div>            
        </div>

        <!-- Modal para ingresar como Administrador -->
        <div id="admin-menu" class="modal-overlay hidden">
            <div class="modal-content">
                <h2 id="admin-text">Ingresar como Administrador</h2>
                <form>
                    <input type="text" placeholder="Usuario Administrador" required>
                    <input type="password" placeholder="Contraseña Administrador" required>
                    
                    <!-- Contenedor para los botones -->
                    <div class="button-container">
                        <button id="admin-inner-btn" type="submit">Ingresar</button>
                        <button id="close-admin-btn" type="button">Cerrar</button>
                        <button id="redirect-login-admin-btn" type="button">Volver al Login</button>
                    </div>
                </form>       
            </div>            
        </div>
            
        <!-- Apartado para mostrar un mapa simple -->
        <div id="simple-map" style="height: 500px; width: 100%; margin-top: 20px;"></div>

        <script>
  // Función para inicializar un mapa con lógica avanzada
  function initSimpleMap() {
    const ubicacion = { lat: 4.6482837, lng: -74.2478946 }; // Ubicación inicial (Bogotá, Colombia)

    // Crear el mapa en el contenedor con id "map"
    const map = new google.maps.Map(document.getElementById("map"), {
      center: ubicacion,
      zoom: 14, // Nivel de zoom
    });

    // Crear la ventana de información
    const infowindow = new google.maps.InfoWindow();

    // Obtener el token del almacenamiento local
    const token = localStorage.getItem("token");
    if (!token) {
      console.error("No se encontró un token. Por favor, inicia sesión.");
      return;
    }

    // Obtener las canchas registradas desde el backend
    fetch("http://localhost:5000/canchas", {
      method: "GET",
      headers: {
        "Authorization": `Bearer ${token}`, // Incluir el token en los headers
      },
    })
      .then((response) => {
        if (!response.ok) {
          throw new Error("Error al obtener las canchas registradas.");
        }
        return response.json();
      })
      .then((canchas) => {
        if (canchas.length === 0) {
          console.log("No se encontraron canchas registradas.");
          return;
        }

        // Crear un marcador para cada cancha registrada
        canchas.forEach((cancha) => {
          console.log("Teléfono de la cancha:", cancha.telefono_contacto); // Verifica el valor del teléfono

          createMarker(map, infowindow, {
            cancha_id: cancha.cancha_id,
            imagenes: cancha.imagenes,
            name: cancha.nombre,
            formatted_address: cancha.direccion,
            telefono_contacto: cancha.telefono_contacto, 
            geometry: {
              location: {
                lat: parseFloat(cancha.lat),
                lng: parseFloat(cancha.lng),
              },
            },
          });
        });
      })
      .catch((error) => {
        console.error("Error al obtener las canchas registradas:", error);
      });
  }

  // Función para crear un marcador en el mapa
  function createMarker(map, infowindow, place) {
    if (!place.geometry || !place.geometry.location) return;

    const marker = new google.maps.Marker({
      map,
      position: place.geometry.location,
    });

    google.maps.event.addListener(marker, "click", () => {
      let content = `<div style="max-width: 300px;">`;

      if (place.imagenes && place.imagenes.length > 0) {
        content += `<div>`;
        place.imagenes.forEach((imagen) => {
          content += `<img src="${imagen}" alt="Imagen de la cancha" style="width:100%; height:auto; max-height:150px; margin-bottom:10px;">`;
        });
        content += `</div>`;
      }

      content += `<strong>${place.name}</strong><br>`;
      content += place.formatted_address ? `${place.formatted_address}<br>` : "";

      // Mostrar el teléfono de contacto
     
        content += `<strong>Teléfono:</strong> ${place.telefono_contacto}<br>`;
      

      content += `<button onclick="window.location.href='reservar.html?cancha_id=${place.cancha_id}'"
                  style="margin-top: 10px; padding: 5px 10px; background-color: #007BFF; color: white; border: none; border-radius: 5px; cursor: pointer;">
                  Reservar
                  </button>`;

      content += `</div>`;

      infowindow.setContent(content);
      infowindow.open(map, marker);
    });
  }

  // Llama a la función initSimpleMap después de que la API de Google Maps se haya cargado
  window.onload = function () {
    initSimpleMap();
  };
</script>

                <!-- Modal de registro -->
        <div id="register-menu" class="modal-overlay hidden">
            <div class="modal-content">
                <h2 id="login-text">Registro</h2>
                <form id="register-form">
                    <input id="register-nombre" type="text" placeholder="Nombre completo" required>
                    <input id="register-email" type="email" placeholder="Correo electrónico" required>
                    <input id="register-password" type="password" placeholder="Contraseña" required>

                    <!-- Botones -->
                    <div class="button-container">
                        <button id="register-inner-btn" type="submit">Registrarse</button>
                        <button id="close-register-btn" type="button">Cerrar</button>
                        <button id="redirect-login-btn" type="button">¿Ya tienes cuenta? Inicia sesión</button>
                    </div>
                </form>
            </div>
        </div>

<!-- Modal de verificación -->
<div id="verify-modal" class="modal-overlay hidden">
  <div class="modal-content">
    <h2>Verificar cuenta</h2>
    <p>Revisa tu correo y escribe aquí el código de verificación para activar tu cuenta.</p>
    <form id="verify-form">
      <input type="email" id="verify-email" placeholder="Correo electrónico" required>
      <input type="text" id="verify-code" placeholder="Código de verificación" required>
      
      <div class="button-container">
        <button id="verify-btn" type="submit">Verificar</button>
        <button id="resend-code-btn" type="button">Reenviar código</button>
        <button type="button" onclick="document.getElementById('verify-modal').classList.add('hidden')">Cerrar</button>
      </div>
    </form>
  </div>
</div>

        <!-- API de Google Maps para cargar el mapa en la página -->
        <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAYDCSXtmUI-KR3qJ29oRdemNUpSIb-UDQ&libraries=places"></script>

        <!-- Script para inicializar el mapa -->
       <!--<script src="map.js"></script>--> 

        <!-- Script que maneja la lógica de navegación entre las secciones -->
        <script src="nav-buttons.js"></script>

        <script src="login.js"></script>
        
        <script src="registerConect.js"></script>

        <script src="loginConect.js"></script>

        <script src="registerUser.js"></script>

        <script src="verify.js"></script>

    </body>
</html>
